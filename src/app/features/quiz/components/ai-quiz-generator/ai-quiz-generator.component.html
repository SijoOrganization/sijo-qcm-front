<div class="sijo-ai-generator">
  <!-- Header Section -->
  <div class="header-section">
    <div class="header-content">
      <div class="header-icon">ü§ñ</div>
      <div class="header-text">
        <h1 class="header-title">G√©n√©rateur de Quiz IA</h1>
        <p class="header-subtitle">Cr√©ez des quiz personnalis√©s avec des questions QCM, de codage et de compl√©tion</p>
      </div>
    </div>
    <div class="header-decoration"></div>
  </div>

  <!-- Main Form -->
  <div class="form-container">
    <form (ngSubmit)="generateQuiz()" class="quiz-form" #quizForm="ngForm">
      
      <!-- Subject Input -->
      <div class="form-group subject-group">
        <label for="subject" class="form-label">
          <span class="label-icon">üìö</span>
          Sujet Principal
        </label>
        <input 
          type="text" 
          id="subject" 
          [(ngModel)]="request.subject" 
          name="subject" 
          class="form-input"
          placeholder="Ex: Programmation Orient√©e Objet, Algorithmes..."
          (input)="onSubjectChange()"
          required>
        <div class="input-decoration"></div>
      </div>

      <!-- Topics Selection -->
      <div class="form-group topics-group">
        <label class="form-label">
          <span class="label-icon">üéØ</span>
          Topics Sp√©cifiques (optionnel)
        </label>
        <div class="topics-container">
          <div 
            *ngFor="let topic of predefinedTopics" 
            class="topic-chip"
            [class.selected]="selectedTopics.includes(topic)"
            (click)="toggleTopic(topic)">
            {{ topic }}
          </div>
        </div>
      </div>

      <!-- Configuration Row -->
      <div class="config-row">
        
        <!-- Language Selection -->
        <div class="form-group">
          <label for="language" class="form-label">
            <span class="label-icon">{{ getLanguageIcon(request.language) }}</span>
            Langage
          </label>
          <select id="language" [(ngModel)]="request.language" name="language" class="form-select">
            <option *ngFor="let lang of languages" [value]="lang.value">
              {{ lang.icon }} {{ lang.label }}
            </option>
          </select>
        </div>

        <!-- Difficulty Selection -->
        <div class="form-group">
          <label for="difficulty" class="form-label">
            <span class="label-icon">‚ö°</span>
            Difficult√©
          </label>
          <div class="difficulty-options">
            <div 
              *ngFor="let diff of difficulties"
              class="difficulty-option"
              [class.selected]="request.difficulty === diff.value"
              [style.border-color]="diff.color"
              (click)="request.difficulty = diff.value">
              <div class="difficulty-indicator" [style.background-color]="diff.color"></div>
              <div class="difficulty-content">
                <span class="difficulty-label">{{ diff.label }}</span>
                <span class="difficulty-description">{{ diff.description }}</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Question Count -->
        <div class="form-group">
          <label for="numberOfQuestions" class="form-label">
            <span class="label-icon">üî¢</span>
            Nombre de Questions
          </label>
          <div class="number-input-container">
            <button 
              type="button" 
              class="number-btn"
              (click)="request.numberOfQuestions = Math.max(1, request.numberOfQuestions - 1)">
              -
            </button>
            <input 
              type="number" 
              id="numberOfQuestions" 
              [(ngModel)]="request.numberOfQuestions" 
              name="numberOfQuestions" 
              class="number-input"
              min="1" 
              max="25">
            <button 
              type="button" 
              class="number-btn"
              (click)="request.numberOfQuestions = Math.min(25, request.numberOfQuestions + 1)">
              +
            </button>
          </div>
        </div>
      </div>

      <!-- Advanced Options -->
      <div class="form-group advanced-options">
        <div class="form-label">
          <span class="label-icon">‚öôÔ∏è</span>
          Options Avanc√©es
        </div>
        <div class="checkbox-group">
          <label class="checkbox-label">
            <input 
              type="checkbox" 
              [(ngModel)]="request.includeCode" 
              name="includeCode"
              class="checkbox-input">
            <span class="checkbox-custom"></span>
            <span class="checkbox-text">Inclure des questions de codage avec tests</span>
          </label>
        </div>
      </div>

      <!-- Generate Button -->
      <div class="submit-section">
        <button 
          type="submit" 
          [disabled]="isGenerating || quizForm.invalid" 
          class="generate-btn"
          [class.generating]="isGenerating">
          
          <div class="btn-content">
            <span class="btn-icon" *ngIf="!isGenerating">üöÄ</span>
            <div class="spinner" *ngIf="isGenerating"></div>
            <span class="btn-text">
              {{ isGenerating ? 'G√©n√©ration en cours...' : 'G√©n√©rer le Quiz' }}
            </span>
          </div>
          
          <div class="btn-decoration" *ngIf="!isGenerating"></div>
        </button>
      </div>
    </form>
  </div>

  <!-- Results Section -->
  <div *ngIf="result" class="result-section animate-in">
    <div class="result-content">
      <div class="result-header">
        <div class="result-icon">‚ú®</div>
        <h3 class="result-title">Quiz g√©n√©r√© avec succ√®s !</h3>
      </div>
      
      <div class="result-stats">
        <div class="stat-item">
          <span class="stat-label">Questions cr√©√©es</span>
          <span class="stat-value">{{ result.questionsGenerated }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">Temps de g√©n√©ration</span>
          <span class="stat-value">{{ result.generationTimeMs }}ms</span>
        </div>
        <div class="stat-item" *ngIf="result.confidence">
          <span class="stat-label">Confiance IA</span>
          <span class="stat-value">{{ (result.confidence * 100) | number:'1.0-0' }}%</span>
        </div>
      </div>
      
      <div class="result-actions">
        <p class="redirect-message">Redirection vers le quiz dans quelques instants...</p>
      </div>
    </div>
  </div>

  <!-- Error Section -->
  <div *ngIf="error" class="error-section animate-in">
    <div class="error-content">
      <div class="error-icon">‚ùå</div>
      <h3 class="error-title">Erreur de g√©n√©ration</h3>
      <p class="error-message">{{ error }}</p>
      <button class="error-retry" (click)="error = null">R√©essayer</button>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div *ngIf="isGenerating" class="loading-overlay">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <h3 class="loading-title">G√©n√©ration en cours...</h3>
      <p class="loading-message">L'IA cr√©e votre quiz personnalis√©</p>
      <div class="loading-progress">
        <div class="progress-bar"></div>
      </div>
    </div>
  </div>
</div>
